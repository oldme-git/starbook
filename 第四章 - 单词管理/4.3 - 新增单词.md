## 添加 Api
---
*api/words/v1/words.go*
```go
type CreateReq struct {  
    g.Meta             `path:"words" method:"post" sm:"创建" tags:"单词"`  
    Word               string `json:"word" v:"required|length:1,100" dc:"单词"`  
    Definition         string `json:"definition" v:"required|length:1,300" dc:"单词定义"`  
    ExampleSentence    string `json:"example_sentence" v:"required|length:1,300" dc:"例句"`  
    ChineseTranslation string `json:"chinese_translation" v:"required|length:1,300" dc:"中文翻译"`  
    Pronunciation      string `json:"pronunciation" v:"required|length:1,100" dc:"发音"`  
}  
  
type CreateRes struct {  
}
```

不能透传
## 添加逻辑
---
*internal/logic/words/words.go*
```go
package words  
  
import (  
    "context"  
  
    "github.com/gogf/gf/v2/errors/gerror"    "star/internal/dao"    "star/internal/model"    "star/internal/model/do")  
  
func Create(ctx context.Context, in *model.WordInput) error {  
    if err := checkWord(ctx, in.Word); err != nil {  
       return err  
    }  
  
    _, err := dao.Words.Ctx(ctx).Data(do.Words{  
       Word:               in.Word,  
       Definition:         in.Definition,  
       ExampleSentence:    in.ExampleSentence,  
       ChineseTranslation: in.ChineseTranslation,  
       Pronunciation:      in.Pronunciation,  
    }).Insert()  
    if err != nil {  
       return err  
    }  
    return nil  
}  
  
func checkWord(ctx context.Context, word string) error {  
    count, err := dao.Words.Ctx(ctx).Where("word", word).Count()  
    if err != nil {  
       return err  
    }  
    if count > 0 {  
       return gerror.New("单词已存在")  
    }  
    return nil  
}
```

## 控制器调用Logic
---
*internal/controller/words/words_v1_create.go*
```go
package words  
  
import (  
    "context"  
  
    "star/internal/logic/words"    "star/internal/model"  
    "star/api/words/v1")  
  
func (c *ControllerV1) Create(ctx context.Context, req *v1.CreateReq) (res *v1.CreateRes, err error) {  
    err = words.Create(ctx, &model.WordInput{  
       Word:               req.Word,  
       Definition:         req.Definition,  
       ExampleSentence:    req.ExampleSentence,  
       ChineseTranslation: req.ChineseTranslation,  
       Pronunciation:      req.Pronunciation,  
    })  
    return nil, err  
}
```
## 注册控制器
---
*internal/cmd/cmd.go*
```go
package cmd  

...

var (  
    Main = gcmd.Command{  
       Name:  "main",  
       Usage: "main",  
       Brief: "start http server",  
       Func: func(ctx context.Context, parser *gcmd.Parser) (err error) {  
          s := g.Server()  
          s.Group("/", func(group *ghttp.RouterGroup) {  
             ...
             group.Group("/", func(group *ghttp.RouterGroup) {  
                group.Middleware(middleware.Auth)  
                group.Group("/v1", func(group *ghttp.RouterGroup) {  
                   group.Bind(  
                      account.NewV1(),  
                      words.NewV1(),  
                   )  
                })  
             })  
          })
          ...
       },  
    }  
)
```

## 接口测试
---
```bash
$ curl -X POST http://127.0.0.1:8000/v1/words \
     -H "Authorization: eyJhbGci...5U" \
     -H "Content-Type: application/json" \
     -d '{
           "word": "example",
           "definition": "A representative form or pattern.",
           "example_sentence": "This is an example sentence.",
           "chinese_translation": "例子",
           "pronunciation": "ɪɡˈzɑːmp(ə)l",
           "proficiency_level": 3
         }'

{
    "code": 0,
    "message": "",
    "data": null
}
```
执行命令，查询数据是否正常添加：
```sql
$ SELECT * FROM words;
```
  
| id  | uid | word    | definition                        | example_sentence             | chinese_translation | pronunciation | proficiency_level | created_at          | updated_at          |
| --- | --- | ------- | --------------------------------- | ---------------------------- | ------------------- | ------------- | ----------------- | ------------------- | ------------------- |
| 1   | 1   | example | A representative form or pattern. | This is an example sentence. | 例子                  | ɪɡˈzɑːmp(ə)l  | 3                 | 2024/11/12 15:38:50 | 2024/11/12 15:38:50 |
